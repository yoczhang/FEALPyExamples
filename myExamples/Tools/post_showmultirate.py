#!/anaconda3/envs/FEALPy/bin python3.8
# -*- coding: utf-8 -*-
# ---
# @Software: PyCharm
# @File: post_showmultirate.py
# @Author: Yongchao Zhang, Northwest University, Xi'an
# @E-mail: yoczhang@nwu.edu.cn
# @Site:
# @Time: Nov 28, 2020
# ---


import numpy as np
from ShowCls import ShowCls
from fealpy.mesh import MeshFactory

# --- mesh1 --- #
p = 1
n = 2
box = [0, 1, 0, 1]  # [0, 1]^2 domain
mf = MeshFactory()
meshtype = 'quad'
mesh = mf.boxmesh2d(box, nx=n, ny=n, meshtype=meshtype)  # 这里 mesh 只是用来初始化

# --- setting the errorType, Ndof, errorMatrix
errorType = ['$\\bf{e_u}$', '$\\eta_h$']

# --- 1
# Ndof = np.array(
#     [1156, 1220, 1284, 1384, 1440, 1540, 1632, 1834, 2138, 2542, 3114, 3850, 4914, 6402, 8200, 10628, 13694, 17504, 22432, 28786,
#      37010, 47090, 59662, 75838, 97126], dtype=np.int)
# errorMatrix = np.array([[1.1555e+00, 9.8976e-01, 8.5203e-01, 7.0781e-01, 6.4650e-01, 5.6002e-01, 4.9564e-01, 4.1141e-01,
#                          3.3548e-01, 2.7535e-01, 2.2500e-01, 1.7799e-01, 1.4232e-01, 1.1417e-01, 9.0159e-02, 7.1493e-02,
#                          5.6420e-02, 4.4774e-02, 3.5566e-02, 2.8458e-02, 2.2695e-02, 1.8067e-02, 1.4443e-02, 1.1481e-02,
#                          9.1255e-03],
#                         [8.3309e-01, 7.1849e-01, 6.3336e-01, 6.1243e-01, 5.2297e-01, 5.1540e-01, 4.5707e-01, 3.9608e-01,
#                          3.3198e-01, 2.7814e-01, 2.2982e-01, 1.8185e-01, 1.4623e-01, 1.1684e-01, 9.2360e-02, 7.3563e-02,
#                          5.8168e-02, 4.5930e-02, 3.6529e-02, 2.9112e-02, 2.2914e-02, 1.8181e-02, 1.4442e-02, 1.1451e-02,
#                          9.0836e-03]],
#                        dtype=np.float)

# --- 2
# Ndof = np.array(
#     [1926, 2034, 2142, 2226, 2310, 2406, 2490, 2574, 2646, 2814, 2886, 3054, 3210, 3450, 3810, 4308, 4746, 5388, 6144, 6990, 8214,
#      9642, 11400, 13638, 16140, 19032], dtype=np.int)
# errorMatrix = np.array([[8.8301e-01, 7.8031e-01, 6.3870e-01, 5.5345e-01, 4.9998e-01, 4.4737e-01, 3.8933e-01, 3.5130e-01,
#                          3.1520e-01, 2.5192e-01, 2.2707e-01, 1.8626e-01, 1.5582e-01, 1.2802e-01, 1.0619e-01, 8.6550e-02,
#                          7.1907e-02, 5.7473e-02, 4.6122e-02, 3.6629e-02, 2.8461e-02, 2.2446e-02, 1.7653e-02, 1.3901e-02,
#                          1.0965e-02, 8.4894e-03],
#                         [5.6820e-01, 5.0875e-01, 4.1899e-01, 3.8659e-01, 3.7897e-01, 2.9913e-01, 2.7641e-01, 2.6882e-01,
#                          2.1721e-01, 1.9804e-01, 1.6401e-01, 1.5196e-01, 1.2675e-01, 1.1104e-01, 9.5739e-02, 7.8184e-02,
#                          6.5742e-02, 5.4106e-02, 4.1978e-02, 3.3623e-02, 2.6672e-02, 2.1201e-02, 1.6677e-02, 1.3115e-02,
#                          1.0352e-02, 7.9897e-03]],
#                        dtype=np.float)

# --- 3
# Ndof = np.array(
#     [2824, 2984, 3144, 3268, 3392, 3536, 3660, 3784, 3892, 4016, 4140, 4248, 4372, 4620, 4728, 4976, 5084, 5332, 5440, 5688, 5920,
#      6304, 6848, 7424, 8192, 9156, 10124, 11108], dtype=np.int)
# errorMatrix = np.array([[7.1761e-01, 5.9547e-01, 5.0983e-01, 4.3432e-01, 3.9095e-01, 3.5034e-01, 2.9912e-01, 2.6778e-01,
#                          2.4059e-01, 2.0659e-01, 1.8488e-01, 1.6614e-01, 1.4348e-01, 1.1790e-01, 1.0114e-01, 8.4145e-02,
#                          7.3286e-02, 6.2364e-02, 5.5595e-02, 4.8928e-02, 4.3420e-02, 3.5950e-02, 2.9298e-02, 2.4038e-02,
#                          1.9418e-02, 1.5124e-02, 1.2150e-02, 9.9216e-03],
#                         [4.4716e-01, 3.7583e-01, 3.2332e-01, 2.8340e-01, 2.7771e-01, 2.2234e-01, 1.9413e-01, 1.8969e-01,
#                          1.5375e-01, 1.3504e-01, 1.3186e-01, 1.0743e-01, 9.5079e-02, 9.1665e-02, 6.8794e-02, 6.6500e-02,
#                          5.2089e-02, 5.0637e-02, 4.2022e-02, 4.1168e-02, 3.6437e-02, 3.0158e-02, 2.5706e-02, 2.0233e-02,
#                          1.6719e-02, 1.3531e-02, 1.0956e-02, 8.9269e-03]],
#                        dtype=np.float)

# --- 4
Ndof = np.array(
    [3850, 4070, 4290, 4460, 4630, 4830, 5000, 5170, 5320, 5490, 5660, 5810, 5980, 6150, 6300, 6470, 6640, 6790, 6960, 7130, 7280,
     7450, 7620, 7770, 7940, 8280, 8430, 8770, 9090, 9620, 10370], dtype=np.int)
errorMatrix = np.array([[5.9641e-01, 4.9512e-01, 4.2626e-01, 3.6300e-01, 3.2603e-01, 2.9255e-01, 2.4961e-01, 2.2317e-01,
                         2.0024e-01, 1.7141e-01, 1.5292e-01, 1.3723e-01, 1.1775e-01, 1.0490e-01, 9.4282e-02, 8.1100e-02,
                         7.2254e-02, 6.5073e-02, 5.6170e-02, 5.0137e-02, 4.5307e-02, 3.9341e-02, 3.5285e-02, 3.2082e-02,
                         2.8153e-02, 2.3650e-02, 2.0923e-02, 1.8113e-02, 1.5475e-02, 1.2864e-02, 1.0141e-02],
                        [3.4359e-01, 2.9309e-01, 2.5594e-01, 2.2739e-01, 2.2108e-01, 1.7566e-01, 1.5535e-01, 1.4960e-01,
                         1.2051e-01, 1.0696e-01, 1.0280e-01, 8.2775e-02, 7.3644e-02, 7.0635e-02, 5.7135e-02, 5.0981e-02,
                         4.8862e-02, 3.9802e-02, 3.5682e-02, 3.4227e-02, 2.8219e-02, 2.5508e-02, 2.4538e-02, 2.0654e-02,
                         1.8928e-02, 1.8260e-02, 1.4863e-02, 1.4462e-02, 1.2297e-02, 1.0304e-02, 8.4906e-03]],
                       dtype=np.float)

sc = ShowCls(p, mesh, errorType=errorType, Ndof=Ndof, errorMatrix=errorMatrix, out=None)
plt = sc.showmultirate(len(Ndof) - 8)
# plt.xlabel('Number of unknowns')
# plt.ylabel('Errors')

print('--- end of the code ---')
